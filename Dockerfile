FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGV2ZW50LWZsb3ctYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEg\
c2FtcGxlIGFwcGxpY2F0aW9uIGdlbmVyYXRlZCBieSBhcGIgaW5pdApiaW5kYWJsZTogRmFsc2UK\
YXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBDbG91ZEV2ZW50IEZsb3cK\
ICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGZhIGZhLXBhcGVyLXBsYW5lCiAgcHJv\
dmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOgogICAgLSAi\
ZG9ja2VyLmlvL3N0cmVhbXppL2Vudmlyb25tZW50LXZhcmlhYmxlLW9wZXJhdG9yOmxhdGVzdCIK\
ICAgIC0gImRvY2tlci5pby9zdHJlYW16aS9ldmVudGZsb3ctb3BlcmF0b3I6bGF0ZXN0IgogICAg\
LSAiZG9ja2VyLmlvL3N0cmVhbXppL2V2ZW50Zmxvdy11aTpsYXRlc3QiCnBsYW5zOgogIC0gbmFt\
ZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRlcGxveXMgZXZl\
bnQtZmxvdy1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVy\
czoKICAgIC0gbmFtZTogYWRtaW5fdXNlcgogICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFVz\
ZXIKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAtIG5hbWU6IGFk\
bWluX3Bhc3N3b3JkCiAgICAgIHRpdGxlOiBPcGVuc2hpZnQgQWRtaW4gUGFzc3dvcmQKICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgcmVxdWlyZWQ6\
IHRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
